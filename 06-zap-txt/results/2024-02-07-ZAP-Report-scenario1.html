<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ZAP Scanning Report</title>
<link
	href="2024-02-07-ZAP-Report-scenario1/normalize/normalize.css" rel="stylesheet">
<link
	href="2024-02-07-ZAP-Report-scenario1/themes/original/main.css" rel="stylesheet">
<link
	href="2024-02-07-ZAP-Report-scenario1/themes/original/colors.css" rel="stylesheet">
</head>
<body>
	<header>
		<h1>ZAP Scanning Report</h1>
		<p>
			<span>Generated with</span> <a href="https://zaproxy.org"><img
				src="2024-02-07-ZAP-Report-scenario1/zap32x32.png" alt="The ZAP logo" class="zap-logo">ZAP</a>
			<span>on Wed 7 Feb 2024, at 21:29:27</span>
		</p>
		<p>ZAP Version: 2.14.0</p>
	</header>

	<main>

		<section id="contents" class="contents">
			<h2>Contents</h2>
			<nav>
				<ol>
					<li><a
						href="#about-this-report">About this report</a>
						<ol>
							
							<li><a
								href="#report-parameters">Report parameters</a></li>
						</ol></li>
					<data-th-block>
					<li><a
						href="#summaries">Summaries</a>
						<ol>
							<li><a
								href="#risk-confidence-counts">Alert counts by risk and confidence</a></li>
							<li><a
								href="#site-risk-counts">Alert counts by site and risk</a></li>
							<li><a
								href="#alert-type-counts">Alert counts by alert type</a></li>
						</ol></li>
					<li><a
						href="#alerts">Alerts</a>
						<ol>
							
							
							
							
							
							
							
							<li><a
								href="#alerts--risk-3-confidence-2"><span>Risk</span>=<span
									class="risk-level">High</span>, <span>Confidence</span>=<span
									class="confidence-level">Medium</span> <span>(2)</span></a></li>
							
							
							  
							
							
							
							
							
							
							<li><a
								href="#alerts--risk-2-confidence-2"><span>Risk</span>=<span
									class="risk-level">Medium</span>, <span>Confidence</span>=<span
									class="confidence-level">Medium</span> <span>(2)</span></a></li>
							
							
							  
							 
							 
						</ol></li>
					<li><a
						href="#appendix">Appendix</a>
						<ol>
							<li><a
								href="#alert-types">Alert types</a></li>
						</ol></li>
					</data-th-block>
				</ol>
			</nav>
		</section>

		<section
			id="about-this-report" class="about-this-report">
			<h2>About this report</h2>

			

			<section
				id="report-parameters">
				<h3>Report parameters</h3>
				<div class="report-parameters--container">
					<h4>Contexts</h4>
					
					
					<p>No contexts were selected, so all contexts were included by default.</p>
					  

					<h4>Sites</h4>
					
					<p>The following sites were included:</p>
					<ul class="sites-list">
						<li><span class="site">http://localhost:10001</span></li>
					</ul>
					
					<p>(If no sites were selected, all sites were included by default.)</p>
					<p>An included site must also be within one of the included contexts for its data to be included in the report.</p>

					<h4>Risk levels</h4>
					<p>
						<span>Included</span>:
						 
						<span class="included-risk-codes"><span class="risk-level">High</span>, <span class="risk-level">Medium</span>, <span class="risk-level">Low</span>, <span class="risk-level">Informational</span></span>
					</p>
					<p>
						<span>Excluded</span>:
						 <span>None</span>
						
					</p>

					<h4>Confidence levels</h4>
					<p>
						<span>Included</span>:
						
						
						<span class="included-confidence-codes"><span class="confidence-level">User Confirmed</span>, <span class="confidence-level">High</span>, <span class="confidence-level">Medium</span>, <span class="confidence-level">Low</span></span>
					</p>
					<p>
						<span>Excluded</span>:
						
						
						<span class="included-confidence-codes"> <span class="confidence-level">User Confirmed</span>, <span class="confidence-level">High</span>, <span class="confidence-level">Medium</span>, <span class="confidence-level">Low</span>, <span class="confidence-level">False Positive</span></span>
					</p>
				</div>
			</section>
		</section>

		
		<section>
			
		</section>
		
		<section id="summaries" class="summaries">
			<h2>Summaries</h2>

			<section
				id="risk-confidence-counts">
				<h3>Alert counts by risk and confidence</h3>
				<table class="risk-confidence-counts-table">
					<caption>
						<p>This table shows the number of alerts for each level of risk and confidence included in the report.</p>
						<p>(The percentages in brackets represent the count as a percentage of the total number of alerts included in the report, rounded to one decimal place.)</p>
					</caption>
					<colgroup>
						<col>
						<col>
					</colgroup>
					<colgroup>
						<col
							style="width: 14.0%"><col
							style="width: 14.0%"><col
							style="width: 14.0%"><col
							style="width: 14.0%">
						<col style="width: 14.0%">
					</colgroup>
					<thead>
						<tr>
							<td colspan="2" rowspan="2"></td>
							<th scope="colgroup"
								colspan="5">Confidence</th>
						</tr>
						<tr>
							<th scope="col">User Confirmed</th>
							<th scope="col">High</th>
							<th scope="col">Medium</th>
							<th scope="col">Low</th>
							<th scope="col">Total</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th scope="rowgroup"
								rowspan="5">Risk</th>
							<th scope="row">High</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>2</span><br> <span
								class="additional-info-percentages">(50.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>2</span><br> <span class="additional-info-percentages">(50.0%)</span></td>
						</tr>
						<tr>
							
							<th scope="row">Medium</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>2</span><br> <span
								class="additional-info-percentages">(50.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>2</span><br> <span class="additional-info-percentages">(50.0%)</span></td>
						</tr>
						<tr>
							
							<th scope="row">Low</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span class="additional-info-percentages">(0.0%)</span></td>
						</tr>
						<tr>
							
							<th scope="row">Informational</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span class="additional-info-percentages">(0.0%)</span></td>
						</tr>
						<tr>
							<th scope="row">Total</th>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>4</span><br> <span
								class="additional-info-percentages">(100.0%)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(0.0%)</span></td>
							<td><span>4</span><br> <span
								class="additional-info-percentages">(100%)</span></td>
						</tr>
					</tbody>
				</table>
			</section>

			<section
				id="site-risk-counts">
				<h3>Alert counts by site and risk</h3>
				<table class="site-risk-counts-table">
					<caption>
						<p>This table shows, for each site for which one or more alerts were raised, the number of alerts raised at each risk level.</p>
						<p>Alerts with a confidence level of &quot;False Positive&quot; have been excluded from these counts.</p>
						<p>(The numbers in brackets are the number of alerts raised for the site at or above that risk level.)</p>
					</caption>
					<colgroup>
						<col>
						<col>
					</colgroup>
					<colgroup>
						<col
							style="width: 16.25%"><col
							style="width: 16.25%"><col
							style="width: 16.25%"><col
							style="width: 16.25%">
					</colgroup>
					<thead>
						<tr>
							<td colspan="2" rowspan="2"></td>
							<th scope="colgroup" colspan="4">Risk</th>
						</tr>
						<tr>
							<th scope="col">
								<span>High</span><br>  <span
									class="additional-info-percentages">(= High)</span>  
							</th>
							<th scope="col">
								<span>Medium</span><br>   <span
									class="additional-info-percentages">(&gt;= Medium)</span> 
							</th>
							<th scope="col">
								<span>Low</span><br>   <span
									class="additional-info-percentages">(&gt;= Low)</span> 
							</th>
							<th scope="col">
								<span>Informational</span><br>   <span
									class="additional-info-percentages">(&gt;= Informational)</span> 
							</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th scope="rowgroup"
								rowspan="1">Site</th>
							<th scope="row">http://localhost:10001</th>
							
							<td><span>2</span><br> <span
								class="additional-info-percentages">(2)</span></td>
							<td><span>2</span><br> <span
								class="additional-info-percentages">(4)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(4)</span></td>
							<td><span>0</span><br> <span
								class="additional-info-percentages">(4)</span></td>
							
						</tr>
					</tbody>
				</table>
			</section>

			<section
				id="alert-type-counts">
				<h3>Alert counts by alert type</h3>
				<table class="alert-type-counts-table">
					<caption>
						<p>This table shows the number of alerts of each alert type, together with the alert type&#39;s risk level.</p>
						<p>(The percentages in brackets represent each count as a percentage, rounded to one decimal place, of the total number of alerts included in this report.)</p>
					</caption>
					<thead>
						<tr>
							<th scope="col">Alert type</th>
							<th scope="col">Risk</th>
							<th scope="col">Count</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th scope="row"><a
								href="#alert-type-0">Remote code execution by uploading Jpeg image containing Php content.</a></th>
							<td class="risk-level">High</td>
							<td><span>1</span><br> <span
								class="additional-info-percentages">(25.0%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-1">Remote code execution by uploading Php file.</a></th>
							<td class="risk-level">High</td>
							<td><span>1</span><br> <span
								class="additional-info-percentages">(25.0%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-2">Eicar antivirus file upload attack</a></th>
							<td class="risk-level">Medium</td>
							<td><span>1</span><br> <span
								class="additional-info-percentages">(25.0%)</span></td>
						</tr>
						<tr>
							<th scope="row"><a
								href="#alert-type-3">Upload and download of html/htm/xhtml or other variants extension file.</a></th>
							<td class="risk-level">Medium</td>
							<td><span>1</span><br> <span
								class="additional-info-percentages">(25.0%)</span></td>
						</tr>
					</tbody>
					<tfoot>
						<tr>
							<th scope="row">Total</th>
							<td></td>
							<td>4</td>
						</tr>
					</tfoot>
				</table>
			</section>
		</section>

		<section id="alerts" class="alerts">
			<h2>Alerts</h2>
			<ol>
				
				 
				
				
				
				
				<li id="alerts--risk-3-confidence-2">
					<h3>
						<span>Risk</span>=<span
							class="risk-level">High</span>, <span>Confidence</span>=<span
							class="confidence-level">Medium</span> <span>(2)</span>
					</h3>
					<ol>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">http://localhost:10001</span> <span>(2)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-0">Remote code execution by uploading Jpeg image containing Php content.</a> <span>(1)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">POST http://localhost:10001/uploads/ImageWithPHPSnippetFileUpload_-7796048789664784898.php</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				
			</ul>
		</td>
	</tr>
	
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>https://cwe.mitre.org/data/definitions/434.html</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (521 bytes)</summary>
				
				<pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 1105
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (1105 bytes)</summary>
				
				<pre><code>-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;ImageWithPHPSnippetFileUpload_-7796048789664784898.php .txt&quot;
Content-Type: text/plain

ÿØÿà JFIF  ` `  ÿþ K&lt;?php echo &quot;ImageWithPHPSnippetFileUpload_&quot;.&quot;SasanLabs_ZAP_Identifier&quot; ?&gt;ÿÛ C 		
 $.&#39; &quot;,#(7),01444&#39;9=82&lt;.342ÿÛ C			2!!22222222222222222222222222222222222222222222222222ÿÀ   &quot; ÿÄ           	
ÿÄ µ   } !1AQa&quot;q2¡#B±ÁRÑð$3br	
%&amp;&#39;()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz¢£¤¥¦§¨©ª²³´µ¶·¸¹ºÂÃÄÅÆÇÈÉÊÒÓÔÕÖ×ØÙÚáâãäåæçèéêñòóôõö÷øùúÿÄ        	
ÿÄ µ  w !1AQaq&quot;2B¡±Á	#3RðbrÑ
$4á%ñ&amp;&#39;()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz¢£¤¥¦§¨©ª²³´µ¶·¸¹ºÂÃÄÅÆÇÈÉÊÒÓÔÕÖ×ØÙÚâãäåæçèéêòóôõö÷øùúÿÚ   ? ÷ú(¢?ÿÙ
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (254 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:40 GMT
Server: Apache/2.4.57 (Debian)
X-Powered-By: PHP/8.3.2
Vary: Accept-Encoding
Content-Length: 3452
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3452 bytes)</summary>
				
				<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;link href=&quot;/menue/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;title&gt;FUEL&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;/menue/css/styles.css&quot;&gt;
&lt;/head&gt;&lt;body&gt;
&lt;nav class=&quot;navbar navbar-expand-lg bg-primary-subtle&quot;&gt;
  &lt;div class=&quot;container-fluid&quot;&gt;
    &lt;a class=&quot;navbar-brand&quot; href=&quot;/menue/&quot;&gt;FUEL&lt;/a&gt;
    &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-bs-toggle=&quot;collapse&quot; data-bs-target=&quot;#navbarSupportedContent&quot; aria-controls=&quot;navbarSupportedContent&quot; aria-expanded=&quot;false&quot; aria-label=&quot;Toggle navigation&quot;&gt;
      &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
    &lt;/button&gt;
    &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarSupportedContent&quot;&gt;
      &lt;ul class=&quot;navbar-nav me-auto mb-2 mb-lg-0&quot;&gt;    
        &lt;li class=&quot;nav-item&quot;&gt;
          &lt;a class=&quot;nav-link&quot; href=&quot;https://github.com/FUEL-Project/FUEL-FileUploadExploitationLab&quot;&gt;About FUEL&lt;/a&gt;
        &lt;/li&gt;
        &lt;li class=&quot;nav-item dropdown&quot;&gt;
          &lt;a class=&quot;nav-link dropdown-toggle&quot; href=&quot;#&quot; role=&quot;button&quot; data-bs-toggle=&quot;dropdown&quot; aria-expanded=&quot;false&quot;&gt;
            Scenarios
          &lt;/a&gt;
          &lt;ul class=&quot;dropdown-menu&quot;&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10001/&quot;&gt;Scenario 1&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10002/&quot;&gt;Scenario 2&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10003/&quot;&gt;Scenario 3&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10004/&quot;&gt;Scenario 4&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10005/&quot;&gt;Scenario 5&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10006/&quot;&gt;Scenario 6&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10007/&quot;&gt;Scenario 7&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10008/&quot;&gt;Scenario 8&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10009/&quot;&gt;Scenario 9&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10010/&quot;&gt;Scenario 10&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10011/&quot;&gt;Scenario 11&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10012/&quot;&gt;Scenario 12&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10013/&quot;&gt;Scenario 13&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 14&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 15&lt;/a&gt;&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/nav&gt;&lt;h1&gt;Scenario 1&lt;/h1&gt;
&lt;p&gt;In this basic scenario, there are no filters and any file can be uploaded.&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;

&lt;div class=&quot;upload-form&quot;&gt;
    &lt;h2&gt;Upload an Image!&lt;/h2&gt;
    &lt;form action=&quot;&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
      &lt;label for=&quot;fileToUpload&quot;&gt;Select a file:&lt;/label&gt;
      &lt;input type=&quot;file&quot; name=&quot;fileToUpload&quot; id=&quot;fileToUpload&quot;&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Upload&quot; name=&quot;submit&quot;&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;a href=&#39;uploads/ImageWithPHPSnippetFileUpload_-7796048789664784898.php&#39;&gt;See the image!&lt;/a&gt;
&lt;script src=&quot;/menue/js/popper.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/jquery-3.5.1.slim.min.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 1105
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;ImageWithPHPSnippetFileUpload_-7796048789664784898.php .txt&quot;
Content-Type: text/plain

ÿØÿà JFIF  ` `  ÿþ K&lt;?php echo &quot;ImageWithPHPSnippetFileUpload_&quot;.&quot;SasanLabs_ZAP_Identifier&quot; ?&gt;ÿÛ C 		
 $.&#39; &quot;,#(7),01444&#39;9=82&lt;.342ÿÛ C			2!!22222222222222222222222222222222222222222222222222ÿÀ   &quot; ÿÄ           	
ÿÄ µ   } !1AQa&quot;q2¡#B±ÁRÑð$3br	
%&amp;&#39;()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz¢£¤¥¦§¨©ª²³´µ¶·¸¹ºÂÃÄÅÆÇÈÉÊÒÓÔÕÖ×ØÙÚáâãäåæçèéêñòóôõö÷øùúÿÄ        	
ÿÄ µ  w !1AQaq&quot;2B¡±Á	#3RðbrÑ
$4á%ñ&amp;&#39;()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz¢£¤¥¦§¨©ª²³´µ¶·¸¹ºÂÃÄÅÆÇÈÉÊÒÓÔÕÖ×ØÙÚâãäåæçèéêòóôõö÷øùúÿÚ   ? ÷ú(¢?ÿÙ
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Attack</th>
		<td><pre><code>Retrieval Request: GET http://localhost:10001/uploads/ImageWithPHPSnippetFileUpload_-7796048789664784898.php HTTP/1.0
host: localhost:10001

 
 Retrieval Response: HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:40 GMT
Server: Apache/2.4.57 (Debian)
X-Powered-By: PHP/8.3.2
Vary: Accept-Encoding
Content-Length: 689
Connection: close
Content-Type: text/html; charset=UTF-8

���� JFIF  ` `  �� KImageWithPHPSnippetFileUpload_SasanLabs_ZAP_Identifier�� C 		
 $.&#39; &quot;,#(7),01444&#39;9=82&lt;.342�� C			2!!22222222222222222222222222222222222222222222222222��   &quot; ��           	
�� �   } !1AQa&quot;q2���#B��R��$3br�	
%&amp;&#39;()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������        	
�� �  w !1AQaq&quot;2�B����	#3R�br�
$4�%�&amp;&#39;()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ��(��?��</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Follow the suggestions mentioned in following links: 1. https://www.acunetix.com/websitesecurity/upload-forms-threat/ 2. https://portswigger.net/kb/issues/00500980_file-upload-functionality 3. https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload 4. https://www.youtube.com/watch?v=CmF9sEyKZNo 5. https://cwe.mitre.org/data/definitions/434.html</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
								<li>
									<h5>
										<a
											href="#alert-type-1">Remote code execution by uploading Php file.</a> <span>(1)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">POST http://localhost:10001/uploads/SimplePHPFileUpload_-7796048789664784898.php</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				
			</ul>
		</td>
	</tr>
	
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>https://cwe.mitre.org/data/definitions/434.html</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (520 bytes)</summary>
				
				<pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 450
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (450 bytes)</summary>
				
				<pre><code>-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;SimplePHPFileUpload_-7796048789664784898.php .txt&quot;
Content-Type: text/plain

&lt;?php echo &quot;SimplePHPFileUpload&quot;.&quot;_SasanLabs_ZAP_Identifier&quot; ?&gt;
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (254 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:40 GMT
Server: Apache/2.4.57 (Debian)
X-Powered-By: PHP/8.3.2
Vary: Accept-Encoding
Content-Length: 3442
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3442 bytes)</summary>
				
				<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;link href=&quot;/menue/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;title&gt;FUEL&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;/menue/css/styles.css&quot;&gt;
&lt;/head&gt;&lt;body&gt;
&lt;nav class=&quot;navbar navbar-expand-lg bg-primary-subtle&quot;&gt;
  &lt;div class=&quot;container-fluid&quot;&gt;
    &lt;a class=&quot;navbar-brand&quot; href=&quot;/menue/&quot;&gt;FUEL&lt;/a&gt;
    &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-bs-toggle=&quot;collapse&quot; data-bs-target=&quot;#navbarSupportedContent&quot; aria-controls=&quot;navbarSupportedContent&quot; aria-expanded=&quot;false&quot; aria-label=&quot;Toggle navigation&quot;&gt;
      &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
    &lt;/button&gt;
    &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarSupportedContent&quot;&gt;
      &lt;ul class=&quot;navbar-nav me-auto mb-2 mb-lg-0&quot;&gt;    
        &lt;li class=&quot;nav-item&quot;&gt;
          &lt;a class=&quot;nav-link&quot; href=&quot;https://github.com/FUEL-Project/FUEL-FileUploadExploitationLab&quot;&gt;About FUEL&lt;/a&gt;
        &lt;/li&gt;
        &lt;li class=&quot;nav-item dropdown&quot;&gt;
          &lt;a class=&quot;nav-link dropdown-toggle&quot; href=&quot;#&quot; role=&quot;button&quot; data-bs-toggle=&quot;dropdown&quot; aria-expanded=&quot;false&quot;&gt;
            Scenarios
          &lt;/a&gt;
          &lt;ul class=&quot;dropdown-menu&quot;&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10001/&quot;&gt;Scenario 1&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10002/&quot;&gt;Scenario 2&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10003/&quot;&gt;Scenario 3&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10004/&quot;&gt;Scenario 4&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10005/&quot;&gt;Scenario 5&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10006/&quot;&gt;Scenario 6&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10007/&quot;&gt;Scenario 7&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10008/&quot;&gt;Scenario 8&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10009/&quot;&gt;Scenario 9&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10010/&quot;&gt;Scenario 10&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10011/&quot;&gt;Scenario 11&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10012/&quot;&gt;Scenario 12&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10013/&quot;&gt;Scenario 13&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 14&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 15&lt;/a&gt;&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/nav&gt;&lt;h1&gt;Scenario 1&lt;/h1&gt;
&lt;p&gt;In this basic scenario, there are no filters and any file can be uploaded.&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;

&lt;div class=&quot;upload-form&quot;&gt;
    &lt;h2&gt;Upload an Image!&lt;/h2&gt;
    &lt;form action=&quot;&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
      &lt;label for=&quot;fileToUpload&quot;&gt;Select a file:&lt;/label&gt;
      &lt;input type=&quot;file&quot; name=&quot;fileToUpload&quot; id=&quot;fileToUpload&quot;&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Upload&quot; name=&quot;submit&quot;&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;a href=&#39;uploads/SimplePHPFileUpload_-7796048789664784898.php&#39;&gt;See the image!&lt;/a&gt;
&lt;script src=&quot;/menue/js/popper.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/jquery-3.5.1.slim.min.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 450
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;SimplePHPFileUpload_-7796048789664784898.php .txt&quot;
Content-Type: text/plain

&lt;?php echo &quot;SimplePHPFileUpload&quot;.&quot;_SasanLabs_ZAP_Identifier&quot; ?&gt;
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Attack</th>
		<td><pre><code>Retrieval Request: GET http://localhost:10001/uploads/SimplePHPFileUpload_-7796048789664784898.php HTTP/1.0
host: localhost:10001

 
 Retrieval Response: HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:40 GMT
Server: Apache/2.4.57 (Debian)
X-Powered-By: PHP/8.3.2
Content-Length: 44
Connection: close
Content-Type: text/html; charset=UTF-8

SimplePHPFileUpload_SasanLabs_ZAP_Identifier</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Follow the suggestions mentioned in following links: 1. https://www.acunetix.com/websitesecurity/upload-forms-threat/ 2. https://portswigger.net/kb/issues/00500980_file-upload-functionality 3. https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload 4. https://www.youtube.com/watch?v=CmF9sEyKZNo </p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
					</ol>
				</li>
				
				
				  
				 
				
				
				
				
				<li id="alerts--risk-2-confidence-2">
					<h3>
						<span>Risk</span>=<span
							class="risk-level">Medium</span>, <span>Confidence</span>=<span
							class="confidence-level">Medium</span> <span>(2)</span>
					</h3>
					<ol>
						
						<li class="alerts--site-li">
							<h4>
								<span class="site">http://localhost:10001</span> <span>(2)</span>
							</h4>
							<ol>
								
								<li>
									<h5>
										<a
											href="#alert-type-2">Eicar antivirus file upload attack</a> <span>(1)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">POST http://localhost:10001/uploads/fuel.txt</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				
			</ul>
		</td>
	</tr>
	
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>https://en.wikipedia.org/wiki/EICAR_test_file </p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (520 bytes)</summary>
				
				<pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 414
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (414 bytes)</summary>
				
				<pre><code>-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;fuel.txt&quot;
Content-Type: text/plain

X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (254 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:40 GMT
Server: Apache/2.4.57 (Debian)
X-Powered-By: PHP/8.3.2
Vary: Accept-Encoding
Content-Length: 3406
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3406 bytes)</summary>
				
				<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;link href=&quot;/menue/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;title&gt;FUEL&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;/menue/css/styles.css&quot;&gt;
&lt;/head&gt;&lt;body&gt;
&lt;nav class=&quot;navbar navbar-expand-lg bg-primary-subtle&quot;&gt;
  &lt;div class=&quot;container-fluid&quot;&gt;
    &lt;a class=&quot;navbar-brand&quot; href=&quot;/menue/&quot;&gt;FUEL&lt;/a&gt;
    &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-bs-toggle=&quot;collapse&quot; data-bs-target=&quot;#navbarSupportedContent&quot; aria-controls=&quot;navbarSupportedContent&quot; aria-expanded=&quot;false&quot; aria-label=&quot;Toggle navigation&quot;&gt;
      &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
    &lt;/button&gt;
    &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarSupportedContent&quot;&gt;
      &lt;ul class=&quot;navbar-nav me-auto mb-2 mb-lg-0&quot;&gt;    
        &lt;li class=&quot;nav-item&quot;&gt;
          &lt;a class=&quot;nav-link&quot; href=&quot;https://github.com/FUEL-Project/FUEL-FileUploadExploitationLab&quot;&gt;About FUEL&lt;/a&gt;
        &lt;/li&gt;
        &lt;li class=&quot;nav-item dropdown&quot;&gt;
          &lt;a class=&quot;nav-link dropdown-toggle&quot; href=&quot;#&quot; role=&quot;button&quot; data-bs-toggle=&quot;dropdown&quot; aria-expanded=&quot;false&quot;&gt;
            Scenarios
          &lt;/a&gt;
          &lt;ul class=&quot;dropdown-menu&quot;&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10001/&quot;&gt;Scenario 1&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10002/&quot;&gt;Scenario 2&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10003/&quot;&gt;Scenario 3&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10004/&quot;&gt;Scenario 4&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10005/&quot;&gt;Scenario 5&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10006/&quot;&gt;Scenario 6&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10007/&quot;&gt;Scenario 7&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10008/&quot;&gt;Scenario 8&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10009/&quot;&gt;Scenario 9&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10010/&quot;&gt;Scenario 10&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10011/&quot;&gt;Scenario 11&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10012/&quot;&gt;Scenario 12&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10013/&quot;&gt;Scenario 13&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 14&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 15&lt;/a&gt;&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/nav&gt;&lt;h1&gt;Scenario 1&lt;/h1&gt;
&lt;p&gt;In this basic scenario, there are no filters and any file can be uploaded.&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;

&lt;div class=&quot;upload-form&quot;&gt;
    &lt;h2&gt;Upload an Image!&lt;/h2&gt;
    &lt;form action=&quot;&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
      &lt;label for=&quot;fileToUpload&quot;&gt;Select a file:&lt;/label&gt;
      &lt;input type=&quot;file&quot; name=&quot;fileToUpload&quot; id=&quot;fileToUpload&quot;&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Upload&quot; name=&quot;submit&quot;&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;a href=&#39;uploads/fuel.txt&#39;&gt;See the image!&lt;/a&gt;
&lt;script src=&quot;/menue/js/popper.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/jquery-3.5.1.slim.min.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 414
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;fuel.txt&quot;
Content-Type: text/plain

X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Attack</th>
		<td><pre><code>Retrieval Request: GET http://localhost:10001/uploads/fuel.txt HTTP/1.0
host: localhost:10001

 
 Retrieval Response: HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:40 GMT
Server: Apache/2.4.57 (Debian)
Last-Modified: Wed, 07 Feb 2024 20:08:40 GMT
ETag: W/&quot;44-610d042d41d43&quot;
Accept-Ranges: bytes
Content-Length: 68
Connection: close
Content-Type: text/plain

X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Consider checking the antivirus setup in server, in case the antivirus supports Eicar standards and still doesn&#39;t report issue, try fixing it.https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/10-Business_Logic_Testing/09-Test_Upload_of_Malicious_Files.html#malware</p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
								<li>
									<h5>
										<a
											href="#alert-type-3">Upload and download of html/htm/xhtml or other variants extension file.</a> <span>(1)</span>
									</h5>
									<ol>
										<li><details>
												<summary>
													<span class="request-method-n-url">POST http://localhost:10001/uploads/txt</span>
												</summary>
												
<table class="alerts-table">
	<tr>
		<th scope="row">Alert tags</th>
		<td>
			<ul class="alert-tags-list">
				
			</ul>
		</td>
	</tr>
	
	<tr>
		<th scope="row">Other info</th>
		<td> 
<p>https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload</p>
 </td>
	</tr>
	<tr>
		<th scope="row">Request</th>
		<td><details open="open">
				<summary>Request line and header section (520 bytes)</summary>
				
				<pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 391
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

</code></pre>
				
				
			</details> <details class="request-body" open="open">
				<summary>Request body (391 bytes)</summary>
				
				<pre><code>-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;txt&quot;
Content-Type: text/plain

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Testing XSS&lt;/body&gt;&lt;/html&gt;
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Response</th>
		<td><details open="open">
				<summary>Status line and header section (253 bytes)</summary>
				
				<pre><code>HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:39 GMT
Server: Apache/2.4.57 (Debian)
X-Powered-By: PHP/8.3.2
Vary: Accept-Encoding
Content-Length: 3401
Keep-Alive: timeout=5, max=43
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

</code></pre>
				
				
			</details> <details class="response-body">
				<summary>Response body (3401 bytes)</summary>
				
				<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;link href=&quot;/menue/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;title&gt;FUEL&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;/menue/css/styles.css&quot;&gt;
&lt;/head&gt;&lt;body&gt;
&lt;nav class=&quot;navbar navbar-expand-lg bg-primary-subtle&quot;&gt;
  &lt;div class=&quot;container-fluid&quot;&gt;
    &lt;a class=&quot;navbar-brand&quot; href=&quot;/menue/&quot;&gt;FUEL&lt;/a&gt;
    &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-bs-toggle=&quot;collapse&quot; data-bs-target=&quot;#navbarSupportedContent&quot; aria-controls=&quot;navbarSupportedContent&quot; aria-expanded=&quot;false&quot; aria-label=&quot;Toggle navigation&quot;&gt;
      &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
    &lt;/button&gt;
    &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarSupportedContent&quot;&gt;
      &lt;ul class=&quot;navbar-nav me-auto mb-2 mb-lg-0&quot;&gt;    
        &lt;li class=&quot;nav-item&quot;&gt;
          &lt;a class=&quot;nav-link&quot; href=&quot;https://github.com/FUEL-Project/FUEL-FileUploadExploitationLab&quot;&gt;About FUEL&lt;/a&gt;
        &lt;/li&gt;
        &lt;li class=&quot;nav-item dropdown&quot;&gt;
          &lt;a class=&quot;nav-link dropdown-toggle&quot; href=&quot;#&quot; role=&quot;button&quot; data-bs-toggle=&quot;dropdown&quot; aria-expanded=&quot;false&quot;&gt;
            Scenarios
          &lt;/a&gt;
          &lt;ul class=&quot;dropdown-menu&quot;&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10001/&quot;&gt;Scenario 1&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10002/&quot;&gt;Scenario 2&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10003/&quot;&gt;Scenario 3&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10004/&quot;&gt;Scenario 4&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10005/&quot;&gt;Scenario 5&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10006/&quot;&gt;Scenario 6&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10007/&quot;&gt;Scenario 7&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10008/&quot;&gt;Scenario 8&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10009/&quot;&gt;Scenario 9&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10010/&quot;&gt;Scenario 10&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10011/&quot;&gt;Scenario 11&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10012/&quot;&gt;Scenario 12&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10013/&quot;&gt;Scenario 13&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 14&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; href=&quot;http://localhost:10014/&quot;&gt;Scenario 15&lt;/a&gt;&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/nav&gt;&lt;h1&gt;Scenario 1&lt;/h1&gt;
&lt;p&gt;In this basic scenario, there are no filters and any file can be uploaded.&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;

&lt;div class=&quot;upload-form&quot;&gt;
    &lt;h2&gt;Upload an Image!&lt;/h2&gt;
    &lt;form action=&quot;&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
      &lt;label for=&quot;fileToUpload&quot;&gt;Select a file:&lt;/label&gt;
      &lt;input type=&quot;file&quot; name=&quot;fileToUpload&quot; id=&quot;fileToUpload&quot;&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Upload&quot; name=&quot;submit&quot;&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;a href=&#39;uploads/txt&#39;&gt;See the image!&lt;/a&gt;
&lt;script src=&quot;/menue/js/popper.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/menue/js/jquery-3.5.1.slim.min.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
				
				
			</details></td>
	</tr>
	<tr>
		<th scope="row">Parameter</th>
		<td><pre><code>POST http://localhost:10001/ HTTP/1.1
host: localhost:10001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://localhost:10001/
Content-Type: multipart/form-data; boundary=---------------------------143206420139772123452755602442
content-length: 391
Origin: http://localhost:10001
Connection: keep-alive
Upgrade-Insecure-Requests: 1

-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;fileToUpload&quot;; filename=&quot;txt&quot;
Content-Type: text/plain

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Testing XSS&lt;/body&gt;&lt;/html&gt;
-----------------------------143206420139772123452755602442
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------143206420139772123452755602442--
</code></pre></td>
	</tr>
	<tr>
		<th scope="row">Attack</th>
		<td><pre><code>Retrieval Request: GET http://localhost:10001/uploads/txt HTTP/1.0
host: localhost:10001

 
 Retrieval Response: HTTP/1.1 200 OK
Date: Wed, 07 Feb 2024 20:08:39 GMT
Server: Apache/2.4.57 (Debian)
Last-Modified: Wed, 07 Feb 2024 20:08:39 GMT
ETag: W/&quot;32-610d042c86a6e&quot;
Accept-Ranges: bytes
Content-Length: 50
Connection: close

&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;Testing XSS&lt;/body&gt;&lt;/html&gt;</code></pre></td>
	</tr>
	
	<tr>
		<th scope="row">Solution</th>
		<td> 
<p>Follow the suggestions mentioned in following links: 1. https://wiki.owasp.org/index.php/Testing_for_Stored_Cross_site_scripting_(OTG-INPVAL-002)#:~:text=File%20Upload 2. https://portswigger.net/kb/issues/00500980_file-upload-functionality 3. https://www.youtube.com/watch?v=CmF9sEyKZNo </p>
 </td>
	</tr>
</table>

											</details></li>
									</ol>
								</li>
								
							</ol>
						</li>
						
					</ol>
				</li>
				
				
				  
				 
				 
			</ol>
		</section>

		<section id="appendix" class="appendix">
			<h2>Appendix</h2>

			<section id="alert-types" class="alert-types">
				<h3>Alert types</h3>
				<p class="alert-types-intro">This section contains additional information on the types of alerts in the report.</p>
				<ol>
					<li
						id="alert-type-0">
						<h4>Remote code execution by uploading Jpeg image containing Php content.</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by an active scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/40041/">File Upload</a>)
									</span>   
								</td>
							</tr>
							
							
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://cwe.mitre.org/data/definitions/434.html">https://cwe.mitre.org/data/definitions/434.html</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-1">
						<h4>Remote code execution by uploading Php file.</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by an active scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/40041/">File Upload</a>)
									</span>   
								</td>
							</tr>
							
							
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://cwe.mitre.org/data/definitions/434.html">https://cwe.mitre.org/data/definitions/434.html</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-2">
						<h4>Eicar antivirus file upload attack</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by an active scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/40041/">File Upload</a>)
									</span>   
								</td>
							</tr>
							
							
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://cwe.mitre.org/data/definitions/434.html">https://cwe.mitre.org/data/definitions/434.html</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
					<li
						id="alert-type-3">
						<h4>Upload and download of html/htm/xhtml or other variants extension file.</h4>
						<table class="alert-types-table">
							<tr>
								<th scope="row">Source</th>
								<td>
									
									   <span>raised by an active scanner</span> <span>(<a
										href="https://www.zaproxy.org/docs/alerts/40041/">File Upload</a>)
									</span>   
								</td>
							</tr>
							
							
							<tr>
								<th scope="row">Reference</th>
								<td>
									<ol>
										<li><a
											href="https://cwe.mitre.org/data/definitions/434.html">https://cwe.mitre.org/data/definitions/434.html</a></li>
									</ol>
								</td>
							</tr>
						</table>
					</li>
				</ol>
			</section>
		</section>
		 
	</main>
</body>
</html>



